<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>EcommercePro - Mis Compras</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" th:href="@{/css/styles.css}"/>
</head>
<body>
<div th:replace="~{fragments/navbar :: navbar}"></div>
    <!-- Fragmento navbar incluido arriba, se elimina duplicado -->
    <div th:replace="~{fragments/alerts :: alerts}"></div>
    <div th:replace="~{fragments/loader :: loader}"></div>
    <div class="main-container container py-5">
        <div class="row">
            <div class="col-12">
                <h2 class="fw-bold mb-4">Mis Pedidos</h2>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <div th:if="${orders == null or #lists.isEmpty(orders)}" class="alert alert-info">AÃºn no tienes pedidos.</div>
                <div th:if="${orders != null and !#lists.isEmpty(orders)}">
                    <div class="list-group">
            <div th:each="order,iterStat : ${orders}" class="list-group-item list-group-item-action mb-3">
                            <div class="d-flex w-100 justify-content-between">
                <!-- Show a per-user ordinal (works across pagination) -->
                <h5 class="mb-1">Pedido <span th:text="${(currentPage?:0) * (pageSize?:10) + iterStat.index + 1}"></span></h5>
                                <small th:text="${order.date}"></small>
                            </div>
                            <p class="mb-1" th:text="${order.audit}"></p>
                            <div class="d-flex w-100 justify-content-between align-items-center mt-2">
                                <div>
                                    <strong>Total:</strong> S/ <span th:text="${order.total}">0.00</span>
                                </div>
                                <div>
                                    <span class="badge bg-secondary" th:text="${order.status}">PENDING</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <div th:if="${totalPages != null and totalPages > 1}" class="mt-4 d-flex justify-content-center">
                    <nav>
                        <ul class="pagination">
                            <li th:classappend="${currentPage == 0} ? ' disabled' : ''" class="page-item">
                                <a th:href="@{/orders(page=${currentPage - 1},size=${pageSize})}" class="page-link">Prev</a>
                            </li>
                            <li th:each="i : ${#numbers.sequence(0, totalPages - 1)}" th:classappend="${i == currentPage} ? ' active' : ''" class="page-item">
                                <a th:href="@{/orders(page=${i},size=${pageSize})}" class="page-link" th:text="${i + 1}">1</a>
                            </li>
                            <li th:classappend="${currentPage == totalPages - 1} ? ' disabled' : ''" class="page-item">
                                <a th:href="@{/orders(page=${currentPage + 1},size=${pageSize})}" class="page-link">Next</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
    <div th:replace="~{fragments/footer :: footer}"></div>
</body>
</html>
